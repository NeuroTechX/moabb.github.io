
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_benchmark_grid_search.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_benchmark_grid_search.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_benchmark_grid_search.py:


========================================
Benchmarking with MOABB with Grid Search
========================================

This example shows how to use MOABB to benchmark a set of pipelines
on all available datasets. In particular we run the Gridsearch to select the best hyperparameter of some pipelines
and save the gridsearch.
For this example, we will use only one dataset to keep the computation time low, but this benchmark is designed
to easily scale to many datasets.

.. GENERATED FROM PYTHON SOURCE LINES 12-25

.. code-block:: default

    # Authors: Igor Carrara <igor.carrara@inria.fr>
    #
    # License: BSD (3-clause)

    import matplotlib.pyplot as plt

    from moabb import benchmark, set_log_level
    from moabb.analysis.plotting import score_plot


    set_log_level("info")









.. GENERATED FROM PYTHON SOURCE LINES 26-43

In this example, we will use only the dataset 'Zhou 2016'.

Running the benchmark
---------------------

The benchmark is run using the ``benchmark`` function. You need to specify the
folder containing the pipelines to use, the kind of evaluation and the paradigm
to use. By default, the benchmark will use all available datasets for all
paradigms listed in the pipelines. You could restrict to specific evaluation and
paradigm using the ``evaluations`` and ``paradigms`` arguments.

To save computation time, the results are cached. If you want to re-run the
benchmark, you can set the ``overwrite`` argument to ``True``.

It is possible to indicate the folder to cache the results and the one to save
the analysis & figures. By default, the results are saved in the ``results``
folder, and the analysis & figures are saved in the ``benchmark`` folder.

.. GENERATED FROM PYTHON SOURCE LINES 43-61

.. code-block:: default


    # In the results folder we will save the gridsearch evaluation
    # When write the pipeline in ylm file we need to specify the parameter that we want to test, in format
    # pipeline-name__estimator-name_parameter. Note that pipeline and estimator names MUST
    # be in lower case (no capital letters allowed).
    # If the grid search is already implemented it will load the previous results

    results = benchmark(
        pipelines="./pipelines_grid/",
        evaluations=["WithinSession"],
        paradigms=["LeftRightImagery"],
        include_datasets=["Zhou 2016"],
        results="./results/",
        overwrite=False,
        plot=False,
        output="./benchmark/",
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Zhou 2016-WithinSession:   0%|          | 0/4 [00:00<?, ?it/s]/home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/io/cnt/cnt.py:240: RuntimeWarning: overflow encountered in scalar multiply
      data_size // (n_samples * n_channels) not in [2, 4]):
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    Zhou 2016-WithinSession:  25%|##5       | 1/4 [00:10<00:32, 10.89s/it]/home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/io/cnt/cnt.py:240: RuntimeWarning: overflow encountered in scalar multiply
      data_size // (n_samples * n_channels) not in [2, 4]):
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    Zhou 2016-WithinSession:  50%|#####     | 2/4 [00:20<00:20, 10.30s/it]/home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/.venv/lib/python3.9/site-packages/mne/io/cnt/cnt.py:240: RuntimeWarning: overflow encountered in scalar multiply
      data_size // (n_samples * n_channels) not in [2, 4]):
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    Zhou 2016-WithinSession:  75%|#######5  | 3/4 [00:30<00:09,  9.89s/it]/home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning:   Could not parse meas date from the header. Setting to None.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    /home/runner/work/moabb/moabb/moabb/datasets/Zhou2016.py:111: RuntimeWarning: Could not define the number of bytes automatically. Defaulting to 2.
      raw = read_raw_cnt(fname, preload=True, eog=["VEOU", "VEOL"])
    Zhou 2016-WithinSession: 100%|##########| 4/4 [00:39<00:00,  9.67s/it]    Zhou 2016-WithinSession: 100%|##########| 4/4 [00:39<00:00,  9.88s/it]
         dataset     evaluation   pipeline  avg score
    0  Zhou 2016  WithinSession  CSP + LDA   0.944031
    1  Zhou 2016  WithinSession    EN Grid   0.948688
    2  Zhou 2016  WithinSession         EN   0.943786




.. GENERATED FROM PYTHON SOURCE LINES 62-65

Benchmark prints a summary of the results. Detailed results are saved in a
pandas dataframe, and can be used to generate figures. The analysis & figures
are saved in the ``benchmark`` folder.

.. GENERATED FROM PYTHON SOURCE LINES 65-68

.. code-block:: default


    score_plot(results)
    plt.show()



.. image-sg:: /auto_examples/images/sphx_glr_plot_benchmark_grid_search_001.png
   :alt: Scores per dataset and algorithm
   :srcset: /auto_examples/images/sphx_glr_plot_benchmark_grid_search_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/moabb/moabb/moabb/analysis/plotting.py:59: UserWarning: The palette list has more values (6) than needed (3), which may not be intended.
      sea.stripplot(





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  39.743 seconds)


.. _sphx_glr_download_auto_examples_plot_benchmark_grid_search.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_benchmark_grid_search.py <plot_benchmark_grid_search.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_benchmark_grid_search.ipynb <plot_benchmark_grid_search.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
